<html>
<title>Events Viewer</title>
<head>
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.18/datatables.min.css"/>

  <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.18/datatables.min.js"></script>

<script>
   var stream_position = sessionStorage.getItem("streamPosition");
   function getSettings() {
     var settings = {
       "async": true,
       "crossDomain": true,
       "url": "https://api.box.com/2.0/events?stream_position=" + stream_position,
       "method": "GET",
       "headers": {
         "Authorization": "Bearer " + sessionStorage.getItem("accessToken"),
         "Cache-Control": "no-cache"
       }
   };
   return settings;
 }
  $(document).ready(function() {
    //get stream posiution
    $.ajax(getSettings()).done(function (response1) {
      console.log("1" + JSON.stringify(response1));
      stream_position=response1.next_stream_position;
    });


  });



</script>

</head>

<body>
  <table id="contentlist" class="display" style="width:100%">
      <thead>
            <th>-</th>
          <th>Name</th>
          <th>Type</th>
          <th>ID</th>
          <th>Modified</th>
          <th>Owner</th>
          <th>Rating</th>
        </thead>
        <tbody>
        </tbody>

          </table>
  </body>
</html>
